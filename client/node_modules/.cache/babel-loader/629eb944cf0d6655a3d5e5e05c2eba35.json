{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _assertThisInitialized2 = _interopRequireDefault(require(\"@babel/runtime/helpers/assertThisInitialized\"));\n\nvar _inherits2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inherits\"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(require(\"@babel/runtime/helpers/possibleConstructorReturn\"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(require(\"@babel/runtime/helpers/getPrototypeOf\"));\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        (0, _defineProperty2.default)(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = (0, _getPrototypeOf2.default)(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = (0, _getPrototypeOf2.default)(this).constructor;\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return (0, _possibleConstructorReturn2.default)(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar PrismaZoom = /*#__PURE__*/function (_PureComponent) {\n  (0, _inherits2.default)(PrismaZoom, _PureComponent);\n\n  var _super = _createSuper(PrismaZoom);\n\n  function PrismaZoom(props) {\n    var _this;\n\n    (0, _classCallCheck2.default)(this, PrismaZoom);\n    _this = _super.call(this, props); // Reference to the main element\n\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"getNewPosition\", function (x, y, zoom) {\n      var _ref = [_this.state.zoom, _this.state.posX, _this.state.posY],\n          prevZoom = _ref[0],\n          prevPosX = _ref[1],\n          prevPosY = _ref[2];\n\n      if (zoom === 1) {\n        return [0, 0];\n      }\n\n      if (zoom > prevZoom) {\n        // Get container coordinates\n        var rect = _this.ref.current.getBoundingClientRect(); // Retrieve rectangle dimensions and mouse position\n\n\n        var centerX = rect.width / 2,\n            centerY = rect.height / 2;\n        var relativeX = x - rect.left - window.pageXOffset,\n            relativeY = y - rect.top - window.pageYOffset; // If we are zooming down, we must try to center to mouse position\n\n        var absX = (centerX - relativeX) / prevZoom,\n            absY = (centerY - relativeY) / prevZoom;\n        var ratio = zoom - prevZoom;\n        return [prevPosX + absX * ratio, prevPosY + absY * ratio];\n      } else {\n        // If we are zooming down, we shall re-center the element\n        return [prevPosX * (zoom - 1) / (prevZoom - 1), prevPosY * (zoom - 1) / (prevZoom - 1)];\n      }\n    });\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"getLimitedShift\", function (shift, minLimit, maxLimit, minElement, maxElement) {\n      if (shift > 0) {\n        if (minElement > minLimit) {\n          // Forbid move if we are moving to left or top while we are already out minimum boudaries\n          return 0;\n        } else if (minElement + shift > minLimit) {\n          // Lower the shift if we are going out boundaries\n          return minLimit - minElement;\n        }\n      } else if (shift < 0) {\n        if (maxElement < maxLimit) {\n          // Forbid move if we are moving to right or bottom while we are already out maximum boudaries\n          return 0;\n        } else if (maxElement + shift < maxLimit) {\n          // Lower the shift if we are going out boundaries\n          return maxLimit - maxElement;\n        }\n      }\n\n      return shift;\n    });\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"getCursor\", function (canMoveOnX, canMoveOnY) {\n      if (canMoveOnX && canMoveOnY) {\n        return 'move';\n      } else if (canMoveOnX) {\n        return 'ew-resize';\n      } else if (canMoveOnY) {\n        return 'ns-resize';\n      } else {\n        return 'auto';\n      }\n    });\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"fullZoomInOnPosition\", function (x, y) {\n      var maxZoom = _this.props.maxZoom;\n      var zoom = maxZoom;\n\n      var _this$getNewPosition = _this.getNewPosition(x, y, zoom),\n          _this$getNewPosition2 = (0, _slicedToArray2.default)(_this$getNewPosition, 2),\n          posX = _this$getNewPosition2[0],\n          posY = _this$getNewPosition2[1];\n\n      _this.setState({\n        zoom: zoom,\n        posX: posX,\n        posY: posY,\n        transitionDuration: _this.props.animDuration\n      });\n    });\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"move\", function (shiftX, shiftY) {\n      var transitionDuration = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n      if (!_this.ref.current) return;\n      var _this$state = _this.state,\n          posX = _this$state.posX,\n          posY = _this$state.posY; // Get container and container's parent coordinates\n\n      var rect = _this.ref.current.getBoundingClientRect();\n\n      var parentRect = _this.ref.current.parentNode.getBoundingClientRect();\n\n      var isLarger = // Check if the element is larger than its container\n      rect.width > parentRect.right - parentRect.left,\n          isOutLeftBoundary = // Check if the element is out its container left boundary\n      shiftX > 0 && rect.left - parentRect.left < 0,\n          isOutRightBoundary = // Check if the element is out its container right boundary\n      shiftX < 0 && rect.right - parentRect.right > 0;\n      var canMoveOnX = isLarger || isOutLeftBoundary || isOutRightBoundary;\n\n      if (canMoveOnX) {\n        posX += _this.getLimitedShift(shiftX, parentRect.left, parentRect.right, rect.left, rect.right);\n      }\n\n      var isHigher = // Check if the element is higher than its container\n      rect.height > parentRect.bottom - parentRect.top,\n          isOutTopBoundary = // Check if the element is out its container top boundary\n      shiftY > 0 && rect.top - parentRect.top < 0,\n          isOutBottomBoundary = // Check if the element is out its container bottom boundary\n      shiftY < 0 && rect.bottom - parentRect.bottom > 0;\n      var canMoveOnY = isHigher || isOutTopBoundary || isOutBottomBoundary;\n\n      if (canMoveOnY) {\n        posY += _this.getLimitedShift(shiftY, parentRect.top, parentRect.bottom, rect.top, rect.bottom);\n      }\n\n      var cursor = _this.getCursor(canMoveOnX, canMoveOnY);\n\n      _this.setState({\n        posX: posX,\n        posY: posY,\n        cursor: cursor,\n        transitionDuration: transitionDuration\n      });\n    });\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"startDeceleration\", function (lastShiftOnX, lastShiftOnY) {\n      var startTimestamp = null;\n\n      var move = function move(timestamp) {\n        if (startTimestamp === null) {\n          startTimestamp = timestamp;\n        }\n\n        var progress = timestamp - startTimestamp; // Calculates the ratio to apply on the move (used to create a non-linear deceleration)\n\n        var ratio = (_this.props.decelerationDuration - progress) / _this.props.decelerationDuration;\n        var shiftX = lastShiftOnX * ratio,\n            shiftY = lastShiftOnY * ratio; // Continue animation only if time has not expired and if there is still some movement (more than 1 pixel on one axis)\n\n        if (progress < _this.props.decelerationDuration && Math.max(Math.abs(shiftX), Math.abs(shiftY)) > 1) {\n          _this.move(shiftX, shiftY, 0);\n\n          _this.lastRequestAnimationId = requestAnimationFrame(move);\n        } else {\n          _this.lastRequestAnimationId = null;\n        }\n      };\n\n      _this.lastRequestAnimationId = requestAnimationFrame(move);\n    });\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"handleMouseWheel\", function (event) {\n      event.preventDefault();\n      var _this$props = _this.props,\n          minZoom = _this$props.minZoom,\n          maxZoom = _this$props.maxZoom,\n          scrollVelocity = _this$props.scrollVelocity;\n      var _this$state2 = _this.state,\n          zoom = _this$state2.zoom,\n          posX = _this$state2.posX,\n          posY = _this$state2.posY; // Use the scroll event delta to determine the zoom velocity\n\n      var velocity = -event.deltaY * scrollVelocity / 100; // Set the new zoom level\n\n      zoom = Math.max(Math.min(zoom + velocity, maxZoom), minZoom);\n\n      if (zoom !== _this.state.zoom) {\n        if (zoom !== minZoom) {\n          var _this$getNewPosition3 = _this.getNewPosition(event.pageX, event.pageY, zoom);\n\n          var _this$getNewPosition4 = (0, _slicedToArray2.default)(_this$getNewPosition3, 2);\n\n          posX = _this$getNewPosition4[0];\n          posY = _this$getNewPosition4[1];\n        } else {\n          // Reset to original position\n          var _ref2 = [_this.constructor.defaultState.posX, _this.constructor.defaultState.posY];\n          posX = _ref2[0];\n          posY = _ref2[1];\n        }\n      }\n\n      _this.setState({\n        zoom: zoom,\n        posX: posX,\n        posY: posY,\n        transitionDuration: 0.05\n      });\n    });\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"handleDoubleClick\", function (event) {\n      event.preventDefault();\n      console.log('a');\n\n      if (_this.state.zoom === _this.props.minZoom) {\n        _this.fullZoomInOnPosition(event.pageX, event.pageY);\n      } else {\n        _this.reset();\n      }\n    });\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"handleMouseStart\", function (event) {\n      event.preventDefault();\n\n      if (_this.lastRequestAnimationId) {\n        cancelAnimationFrame(_this.lastRequestAnimationId);\n      }\n\n      _this.lastCursor = {\n        posX: event.pageX,\n        posY: event.pageY\n      };\n    });\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"handleMouseMove\", function (event) {\n      event.preventDefault();\n\n      if (!_this.lastCursor) {\n        return;\n      }\n\n      var _ref3 = [event.pageX, event.pageY],\n          posX = _ref3[0],\n          posY = _ref3[1];\n      var shiftX = posX - _this.lastCursor.posX;\n      var shiftY = posY - _this.lastCursor.posY;\n\n      _this.move(shiftX, shiftY, 0);\n\n      _this.lastCursor = {\n        posX: posX,\n        posY: posY\n      };\n      _this.lastShift = {\n        x: shiftX,\n        y: shiftY\n      };\n    });\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"handleMouseStop\", function (event) {\n      event.preventDefault();\n\n      if (_this.lastShift) {\n        // Use the last shift to make a decelerating movement effect\n        _this.startDeceleration(_this.lastShift.x, _this.lastShift.y);\n\n        _this.lastShift = null;\n      }\n\n      _this.lastCursor = null;\n\n      _this.setState({\n        cursor: 'auto'\n      });\n    });\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"handleTouchStart\", function (event) {\n      event.preventDefault();\n\n      if (_this.lastRequestAnimationId) {\n        cancelAnimationFrame(_this.lastRequestAnimationId);\n      }\n\n      var _ref4 = [event.touches[0].pageX, event.touches[0].pageY],\n          posX = _ref4[0],\n          posY = _ref4[1];\n\n      if (event.touches.length === 1) {\n        // Check if it is a double tap\n        var touchTime = new Date().getTime();\n\n        if (touchTime - _this.lastTouchTime < _this.props.doubleTouchMaxDelay && touchTime - _this.lastDoubleTapTime > _this.props.doubleTouchMaxDelay) {\n          if (_this.state.zoom === _this.props.minZoom) {\n            _this.fullZoomInOnPosition(posX, posY);\n          } else {\n            _this.reset();\n          }\n\n          _this.lastDoubleTapTime = touchTime;\n        }\n\n        _this.lastTouchTime = touchTime;\n      }\n\n      _this.lastTouch = {\n        posX: posX,\n        posY: posY\n      };\n    });\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"handleTouchMove\", function (event) {\n      event.preventDefault();\n      var _this$props2 = _this.props,\n          maxZoom = _this$props2.maxZoom,\n          minZoom = _this$props2.minZoom;\n      var zoom = _this.state.zoom;\n\n      if (!_this.lastTouch) {\n        return;\n      }\n\n      if (event.touches.length === 1) {\n        var _ref5 = [event.touches[0].pageX, event.touches[0].pageY],\n            posX = _ref5[0],\n            posY = _ref5[1]; // If we detect only one point, we shall just move the element\n\n        var shiftX = posX - _this.lastTouch.posX;\n        var shiftY = posY - _this.lastTouch.posY;\n\n        _this.move(shiftX, shiftY);\n\n        _this.lastShift = {\n          x: shiftX,\n          y: shiftY\n        }; // Save data for the next move\n\n        _this.lastTouch = {\n          posX: posX,\n          posY: posY\n        };\n        _this.lastTouchDistance = null;\n      } else if (event.touches.length > 1) {\n        // If we detect two points, we shall zoom up or down\n        var _ref6 = [event.touches[0].pageX, event.touches[0].pageY],\n            pos1X = _ref6[0],\n            pos1Y = _ref6[1];\n        var _ref7 = [event.touches[1].pageX, event.touches[1].pageY],\n            pos2X = _ref7[0],\n            pos2Y = _ref7[1];\n        var distance = Math.sqrt(Math.pow(pos2X - pos1X, 2) + Math.pow(pos2Y - pos1Y, 2));\n\n        if (_this.lastTouchDistance && distance && distance !== _this.lastTouchDistance) {\n          zoom += (distance - _this.lastTouchDistance) / 100;\n\n          if (zoom > maxZoom) {\n            zoom = maxZoom;\n          } else if (zoom < minZoom) {\n            zoom = minZoom;\n          } // Change position using the center point between the two fingers\n\n\n          var centerX = (pos1X + pos2X) / 2,\n              centerY = (pos1Y + pos2Y) / 2;\n\n          var _this$getNewPosition5 = _this.getNewPosition(centerX, centerY, zoom),\n              _this$getNewPosition6 = (0, _slicedToArray2.default)(_this$getNewPosition5, 2),\n              _posX = _this$getNewPosition6[0],\n              _posY = _this$getNewPosition6[1];\n\n          _this.setState({\n            zoom: zoom,\n            posX: _posX,\n            posY: _posY,\n            transitionDuration: 0\n          });\n        } // Save data for the next move\n\n\n        _this.lastTouch = {\n          posX: pos1X,\n          posY: pos1Y\n        };\n        _this.lastTouchDistance = distance;\n      }\n    });\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"handleTouchStop\", function () {\n      if (_this.lastShift) {\n        // Use the last shift to make a decelerating movement effect\n        _this.startDeceleration(_this.lastShift.x, _this.lastShift.y);\n\n        _this.lastShift = null;\n      }\n\n      _this.lastTouch = null;\n      _this.lastTouchDistance = null;\n    });\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"zoomIn\", function (value) {\n      var maxZoom = _this.props.maxZoom;\n      var _this$state3 = _this.state,\n          zoom = _this$state3.zoom,\n          posX = _this$state3.posX,\n          posY = _this$state3.posY;\n      var prevZoom = zoom;\n      zoom = zoom + value < maxZoom ? zoom + value : maxZoom;\n\n      if (zoom !== prevZoom) {\n        posX = posX * (zoom - 1) / (prevZoom > 1 ? prevZoom - 1 : prevZoom);\n        posY = posY * (zoom - 1) / (prevZoom > 1 ? prevZoom - 1 : prevZoom);\n      }\n\n      _this.setState({\n        zoom: zoom,\n        posX: posX,\n        posY: posY,\n        transitionDuration: _this.props.animDuration\n      });\n    });\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"zoomOut\", function (value) {\n      var minZoom = _this.props.minZoom;\n      var _this$state4 = _this.state,\n          zoom = _this$state4.zoom,\n          posX = _this$state4.posX,\n          posY = _this$state4.posY;\n      var prevZoom = zoom;\n      zoom = zoom - value > minZoom ? zoom - value : minZoom;\n\n      if (zoom !== prevZoom) {\n        posX = posX * (zoom - 1) / (prevZoom - 1);\n        posY = posY * (zoom - 1) / (prevZoom - 1);\n      }\n\n      _this.setState({\n        zoom: zoom,\n        posX: posX,\n        posY: posY,\n        transitionDuration: _this.props.animDuration\n      });\n    });\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"zoomToZone\", function (relX, relY, relWidth, relHeight) {\n      var maxZoom = _this.props.maxZoom;\n      var _this$state5 = _this.state,\n          zoom = _this$state5.zoom,\n          posX = _this$state5.posX,\n          posY = _this$state5.posY;\n\n      var parentRect = _this.ref.current.parentNode.getBoundingClientRect();\n\n      var prevZoom = zoom; // Calculate zoom factor to scale the zone\n\n      var optimalZoomX = parentRect.width / relWidth;\n      var optimalZoomY = parentRect.height / relHeight;\n      zoom = Math.min(optimalZoomX, optimalZoomY, maxZoom); // Calculate new position to center the zone\n\n      var rect = _this.ref.current.getBoundingClientRect();\n\n      var centerX = rect.width / prevZoom / 2,\n          centerY = rect.height / prevZoom / 2;\n      var zoneCenterX = relX + relWidth / 2,\n          zoneCenterY = relY + relHeight / 2;\n      posX = (centerX - zoneCenterX) * zoom;\n      posY = (centerY - zoneCenterY) * zoom;\n\n      _this.setState({\n        zoom: zoom,\n        posX: posX,\n        posY: posY,\n        transitionDuration: _this.props.animDuration\n      });\n    });\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"reset\", function () {\n      _this.setState(_objectSpread(_objectSpread({}, _this.constructor.defaultState), {}, {\n        transitionDuration: _this.props.animDuration\n      }));\n    });\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"getZoom\", function () {\n      return _this.state.zoom;\n    });\n    _this.ref = /*#__PURE__*/(0, _react.createRef)(); // Last cursor position\n\n    _this.lastCursor = null; // Last touch position\n\n    _this.lastTouch = null; // Last touch time in milliseconds\n\n    _this.lastTouchTime = 0; // Last double tap time (used to limit multiple double tap) in milliseconds\n\n    _this.lastDoubleTapTime = 0; // Last calculated distance between two fingers in pixels\n\n    _this.lastTouchDistance = null; // Last request animation frame identifier\n\n    _this.lastRequestAnimationId = null;\n    _this.state = _objectSpread(_objectSpread({}, _this.constructor.defaultState), {}, {\n      transitionDuration: props.animDuration\n    });\n    return _this;\n  }\n  /**\n   * Calculates new translate positions for CSS transformations.\n   * @param  {Number} x     Relative (rect-based) X position in pixels\n   * @param  {Number} y     Relative (rect-based) Y position in pixels\n   * @param  {Number} zoom  Scale value\n   * @return {Array}        New X and Y positions\n   */\n\n\n  (0, _createClass2.default)(PrismaZoom, [{\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(_, prevState) {\n      if (this.props.onZoomChange && this.state.zoom !== prevState.zoom) {\n        this.props.onZoomChange(this.state.zoom);\n      }\n\n      if (this.props.onPanChange && (this.state.posX !== prevState.posX || this.state.posY !== prevState.posY)) {\n        this.props.onPanChange({\n          posX: this.state.posX,\n          posY: this.state.posY\n        });\n      }\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.ref.current.addEventListener('wheel', this.handleMouseWheel.bind(this), {\n        passive: false\n      });\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.ref.current.removeEventListener('wheel', this.handleMouseWheel.bind(this));\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props3 = this.props,\n          className = _this$props3.className,\n          children = _this$props3.children;\n      var _this$state6 = this.state,\n          zoom = _this$state6.zoom,\n          posX = _this$state6.posX,\n          posY = _this$state6.posY,\n          cursor = _this$state6.cursor,\n          transitionDuration = _this$state6.transitionDuration;\n\n      var style = _objectSpread(_objectSpread({}, this.props.style), {}, {\n        transform: \"translate3d(\".concat(posX, \"px, \").concat(posY, \"px, 0) scale(\").concat(zoom, \")\"),\n        transition: \"transform ease-out \".concat(transitionDuration, \"s\"),\n        cursor: cursor,\n        touchAction: 'none',\n        willChange: 'transform'\n      });\n\n      var attr = {\n        ref: this.ref,\n        style: style,\n        className: className\n      };\n\n      if (window.matchMedia(\"(pointer: fine)\").matches) {\n        // Apply mouse events only to devices which include an accurate pointing device\n        attr = _objectSpread(_objectSpread({}, attr), {}, {\n          onDoubleClick: this.handleDoubleClick,\n          onMouseDown: this.handleMouseStart,\n          onMouseMove: this.handleMouseMove,\n          onMouseUp: this.handleMouseStop,\n          onMouseLeave: this.handleMouseStop\n        });\n      } else {\n        // Apply touch events to all other devices\n        attr = _objectSpread(_objectSpread({}, attr), {}, {\n          onTouchStart: this.handleTouchStart,\n          onTouchMove: this.handleTouchMove,\n          onTouchEnd: this.handleTouchStop,\n          onTouchCancel: this.handleTouchStop\n        });\n      }\n\n      return /*#__PURE__*/_react.default.createElement(\"div\", attr, children);\n    }\n  }]);\n  return PrismaZoom;\n}(_react.PureComponent);\n\nexports.default = PrismaZoom;\n(0, _defineProperty2.default)(PrismaZoom, \"propTypes\", {\n  children: _propTypes.default.node.isRequired,\n  className: _propTypes.default.string,\n  style: _propTypes.default.object,\n  minZoom: _propTypes.default.number,\n  maxZoom: _propTypes.default.number,\n  scrollVelocity: _propTypes.default.number,\n  onZoomChange: _propTypes.default.func,\n  onPanChange: _propTypes.default.func,\n  animDuration: _propTypes.default.number,\n  doubleTouchMaxDelay: _propTypes.default.number,\n  decelerationDuration: _propTypes.default.number\n});\n(0, _defineProperty2.default)(PrismaZoom, \"defaultProps\", {\n  // Class name to apply on the zoom wrapper\n  className: null,\n  // Style to apply on the zoom wrapper\n  style: {},\n  // Minimum zoom ratio\n  minZoom: 1,\n  // Maximum zoom ratio\n  maxZoom: 5,\n  // Zoom increment or decrement on each scroll wheel detection\n  scrollVelocity: 0.2,\n  // Function called each time the zoom value changes\n  onZoomChange: null,\n  // Function called each time the posX or posY value changes (aka images was panned)\n  onPanChange: null,\n  // Animation duration (in seconds)\n  animDuration: 0.25,\n  // Max delay between two taps to consider a double tap (in milliseconds)\n  doubleTouchMaxDelay: 300,\n  // Decelerating movement duration after a mouse up or a touch end event (in milliseconds)\n  decelerationDuration: 750\n});\n(0, _defineProperty2.default)(PrismaZoom, \"defaultState\", {\n  // Transform scale value property\n  zoom: 1,\n  // Transform translateX value property\n  posX: 0,\n  // Transform translateY value property\n  posY: 0,\n  // Cursor style property\n  cursor: 'auto'\n});","map":{"version":3,"sources":["/home/jun/foodbank/node_modules/react-prismazoom/dist/index.js"],"names":["_interopRequireWildcard","require","_interopRequireDefault","Object","defineProperty","exports","value","default","_slicedToArray2","_classCallCheck2","_createClass2","_assertThisInitialized2","_inherits2","_possibleConstructorReturn2","_getPrototypeOf2","_defineProperty2","_react","_propTypes","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","getOwnPropertyDescriptors","defineProperties","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","result","NewTarget","constructor","Reflect","construct","sham","Proxy","Boolean","prototype","valueOf","call","e","PrismaZoom","_PureComponent","_super","props","_this","x","y","zoom","_ref","state","posX","posY","prevZoom","prevPosX","prevPosY","rect","ref","current","getBoundingClientRect","centerX","width","centerY","height","relativeX","left","window","pageXOffset","relativeY","top","pageYOffset","absX","absY","ratio","shift","minLimit","maxLimit","minElement","maxElement","canMoveOnX","canMoveOnY","maxZoom","_this$getNewPosition","getNewPosition","_this$getNewPosition2","setState","transitionDuration","animDuration","shiftX","shiftY","undefined","_this$state","parentRect","parentNode","isLarger","right","isOutLeftBoundary","isOutRightBoundary","getLimitedShift","isHigher","bottom","isOutTopBoundary","isOutBottomBoundary","cursor","getCursor","lastShiftOnX","lastShiftOnY","startTimestamp","move","timestamp","progress","decelerationDuration","Math","max","abs","lastRequestAnimationId","requestAnimationFrame","event","preventDefault","_this$props","minZoom","scrollVelocity","_this$state2","velocity","deltaY","min","_this$getNewPosition3","pageX","pageY","_this$getNewPosition4","_ref2","defaultState","console","log","fullZoomInOnPosition","reset","cancelAnimationFrame","lastCursor","_ref3","lastShift","startDeceleration","_ref4","touches","touchTime","Date","getTime","lastTouchTime","doubleTouchMaxDelay","lastDoubleTapTime","lastTouch","_this$props2","_ref5","lastTouchDistance","_ref6","pos1X","pos1Y","_ref7","pos2X","pos2Y","distance","sqrt","pow","_this$getNewPosition5","_this$getNewPosition6","_posX","_posY","_this$state3","_this$state4","relX","relY","relWidth","relHeight","_this$state5","optimalZoomX","optimalZoomY","zoneCenterX","zoneCenterY","createRef","componentDidUpdate","_","prevState","onZoomChange","onPanChange","componentDidMount","addEventListener","handleMouseWheel","bind","passive","componentWillUnmount","removeEventListener","render","_this$props3","className","children","_this$state6","style","transform","concat","transition","touchAction","willChange","attr","matchMedia","matches","onDoubleClick","handleDoubleClick","onMouseDown","handleMouseStart","onMouseMove","handleMouseMove","onMouseUp","handleMouseStop","onMouseLeave","onTouchStart","handleTouchStart","onTouchMove","handleTouchMove","onTouchEnd","handleTouchStop","onTouchCancel","createElement","PureComponent","node","isRequired","string","number","func"],"mappings":"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","sourcesContent":["\"use strict\";\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _assertThisInitialized2 = _interopRequireDefault(require(\"@babel/runtime/helpers/assertThisInitialized\"));\n\nvar _inherits2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inherits\"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(require(\"@babel/runtime/helpers/possibleConstructorReturn\"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(require(\"@babel/runtime/helpers/getPrototypeOf\"));\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0, _defineProperty2.default)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = (0, _getPrototypeOf2.default)(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = (0, _getPrototypeOf2.default)(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return (0, _possibleConstructorReturn2.default)(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nvar PrismaZoom = /*#__PURE__*/function (_PureComponent) {\n  (0, _inherits2.default)(PrismaZoom, _PureComponent);\n\n  var _super = _createSuper(PrismaZoom);\n\n  function PrismaZoom(props) {\n    var _this;\n\n    (0, _classCallCheck2.default)(this, PrismaZoom);\n    _this = _super.call(this, props); // Reference to the main element\n\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"getNewPosition\", function (x, y, zoom) {\n      var _ref = [_this.state.zoom, _this.state.posX, _this.state.posY],\n          prevZoom = _ref[0],\n          prevPosX = _ref[1],\n          prevPosY = _ref[2];\n\n      if (zoom === 1) {\n        return [0, 0];\n      }\n\n      if (zoom > prevZoom) {\n        // Get container coordinates\n        var rect = _this.ref.current.getBoundingClientRect(); // Retrieve rectangle dimensions and mouse position\n\n\n        var centerX = rect.width / 2,\n            centerY = rect.height / 2;\n        var relativeX = x - rect.left - window.pageXOffset,\n            relativeY = y - rect.top - window.pageYOffset; // If we are zooming down, we must try to center to mouse position\n\n        var absX = (centerX - relativeX) / prevZoom,\n            absY = (centerY - relativeY) / prevZoom;\n        var ratio = zoom - prevZoom;\n        return [prevPosX + absX * ratio, prevPosY + absY * ratio];\n      } else {\n        // If we are zooming down, we shall re-center the element\n        return [prevPosX * (zoom - 1) / (prevZoom - 1), prevPosY * (zoom - 1) / (prevZoom - 1)];\n      }\n    });\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"getLimitedShift\", function (shift, minLimit, maxLimit, minElement, maxElement) {\n      if (shift > 0) {\n        if (minElement > minLimit) {\n          // Forbid move if we are moving to left or top while we are already out minimum boudaries\n          return 0;\n        } else if (minElement + shift > minLimit) {\n          // Lower the shift if we are going out boundaries\n          return minLimit - minElement;\n        }\n      } else if (shift < 0) {\n        if (maxElement < maxLimit) {\n          // Forbid move if we are moving to right or bottom while we are already out maximum boudaries\n          return 0;\n        } else if (maxElement + shift < maxLimit) {\n          // Lower the shift if we are going out boundaries\n          return maxLimit - maxElement;\n        }\n      }\n\n      return shift;\n    });\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"getCursor\", function (canMoveOnX, canMoveOnY) {\n      if (canMoveOnX && canMoveOnY) {\n        return 'move';\n      } else if (canMoveOnX) {\n        return 'ew-resize';\n      } else if (canMoveOnY) {\n        return 'ns-resize';\n      } else {\n        return 'auto';\n      }\n    });\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"fullZoomInOnPosition\", function (x, y) {\n      var maxZoom = _this.props.maxZoom;\n      var zoom = maxZoom;\n\n      var _this$getNewPosition = _this.getNewPosition(x, y, zoom),\n          _this$getNewPosition2 = (0, _slicedToArray2.default)(_this$getNewPosition, 2),\n          posX = _this$getNewPosition2[0],\n          posY = _this$getNewPosition2[1];\n\n      _this.setState({\n        zoom: zoom,\n        posX: posX,\n        posY: posY,\n        transitionDuration: _this.props.animDuration\n      });\n    });\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"move\", function (shiftX, shiftY) {\n      var transitionDuration = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n      if (!_this.ref.current) return;\n      var _this$state = _this.state,\n          posX = _this$state.posX,\n          posY = _this$state.posY; // Get container and container's parent coordinates\n\n      var rect = _this.ref.current.getBoundingClientRect();\n\n      var parentRect = _this.ref.current.parentNode.getBoundingClientRect();\n\n      var isLarger = // Check if the element is larger than its container\n      rect.width > parentRect.right - parentRect.left,\n          isOutLeftBoundary = // Check if the element is out its container left boundary\n      shiftX > 0 && rect.left - parentRect.left < 0,\n          isOutRightBoundary = // Check if the element is out its container right boundary\n      shiftX < 0 && rect.right - parentRect.right > 0;\n      var canMoveOnX = isLarger || isOutLeftBoundary || isOutRightBoundary;\n\n      if (canMoveOnX) {\n        posX += _this.getLimitedShift(shiftX, parentRect.left, parentRect.right, rect.left, rect.right);\n      }\n\n      var isHigher = // Check if the element is higher than its container\n      rect.height > parentRect.bottom - parentRect.top,\n          isOutTopBoundary = // Check if the element is out its container top boundary\n      shiftY > 0 && rect.top - parentRect.top < 0,\n          isOutBottomBoundary = // Check if the element is out its container bottom boundary\n      shiftY < 0 && rect.bottom - parentRect.bottom > 0;\n      var canMoveOnY = isHigher || isOutTopBoundary || isOutBottomBoundary;\n\n      if (canMoveOnY) {\n        posY += _this.getLimitedShift(shiftY, parentRect.top, parentRect.bottom, rect.top, rect.bottom);\n      }\n\n      var cursor = _this.getCursor(canMoveOnX, canMoveOnY);\n\n      _this.setState({\n        posX: posX,\n        posY: posY,\n        cursor: cursor,\n        transitionDuration: transitionDuration\n      });\n    });\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"startDeceleration\", function (lastShiftOnX, lastShiftOnY) {\n      var startTimestamp = null;\n\n      var move = function move(timestamp) {\n        if (startTimestamp === null) {\n          startTimestamp = timestamp;\n        }\n\n        var progress = timestamp - startTimestamp; // Calculates the ratio to apply on the move (used to create a non-linear deceleration)\n\n        var ratio = (_this.props.decelerationDuration - progress) / _this.props.decelerationDuration;\n        var shiftX = lastShiftOnX * ratio,\n            shiftY = lastShiftOnY * ratio; // Continue animation only if time has not expired and if there is still some movement (more than 1 pixel on one axis)\n\n        if (progress < _this.props.decelerationDuration && Math.max(Math.abs(shiftX), Math.abs(shiftY)) > 1) {\n          _this.move(shiftX, shiftY, 0);\n\n          _this.lastRequestAnimationId = requestAnimationFrame(move);\n        } else {\n          _this.lastRequestAnimationId = null;\n        }\n      };\n\n      _this.lastRequestAnimationId = requestAnimationFrame(move);\n    });\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"handleMouseWheel\", function (event) {\n      event.preventDefault();\n      var _this$props = _this.props,\n          minZoom = _this$props.minZoom,\n          maxZoom = _this$props.maxZoom,\n          scrollVelocity = _this$props.scrollVelocity;\n      var _this$state2 = _this.state,\n          zoom = _this$state2.zoom,\n          posX = _this$state2.posX,\n          posY = _this$state2.posY; // Use the scroll event delta to determine the zoom velocity\n\n      var velocity = -event.deltaY * scrollVelocity / 100; // Set the new zoom level\n\n      zoom = Math.max(Math.min(zoom + velocity, maxZoom), minZoom);\n\n      if (zoom !== _this.state.zoom) {\n        if (zoom !== minZoom) {\n          var _this$getNewPosition3 = _this.getNewPosition(event.pageX, event.pageY, zoom);\n\n          var _this$getNewPosition4 = (0, _slicedToArray2.default)(_this$getNewPosition3, 2);\n\n          posX = _this$getNewPosition4[0];\n          posY = _this$getNewPosition4[1];\n        } else {\n          // Reset to original position\n          var _ref2 = [_this.constructor.defaultState.posX, _this.constructor.defaultState.posY];\n          posX = _ref2[0];\n          posY = _ref2[1];\n        }\n      }\n\n      _this.setState({\n        zoom: zoom,\n        posX: posX,\n        posY: posY,\n        transitionDuration: 0.05\n      });\n    });\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"handleDoubleClick\", function (event) {\n      event.preventDefault();\n      console.log('a');\n\n      if (_this.state.zoom === _this.props.minZoom) {\n        _this.fullZoomInOnPosition(event.pageX, event.pageY);\n      } else {\n        _this.reset();\n      }\n    });\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"handleMouseStart\", function (event) {\n      event.preventDefault();\n\n      if (_this.lastRequestAnimationId) {\n        cancelAnimationFrame(_this.lastRequestAnimationId);\n      }\n\n      _this.lastCursor = {\n        posX: event.pageX,\n        posY: event.pageY\n      };\n    });\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"handleMouseMove\", function (event) {\n      event.preventDefault();\n\n      if (!_this.lastCursor) {\n        return;\n      }\n\n      var _ref3 = [event.pageX, event.pageY],\n          posX = _ref3[0],\n          posY = _ref3[1];\n      var shiftX = posX - _this.lastCursor.posX;\n      var shiftY = posY - _this.lastCursor.posY;\n\n      _this.move(shiftX, shiftY, 0);\n\n      _this.lastCursor = {\n        posX: posX,\n        posY: posY\n      };\n      _this.lastShift = {\n        x: shiftX,\n        y: shiftY\n      };\n    });\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"handleMouseStop\", function (event) {\n      event.preventDefault();\n\n      if (_this.lastShift) {\n        // Use the last shift to make a decelerating movement effect\n        _this.startDeceleration(_this.lastShift.x, _this.lastShift.y);\n\n        _this.lastShift = null;\n      }\n\n      _this.lastCursor = null;\n\n      _this.setState({\n        cursor: 'auto'\n      });\n    });\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"handleTouchStart\", function (event) {\n      event.preventDefault();\n\n      if (_this.lastRequestAnimationId) {\n        cancelAnimationFrame(_this.lastRequestAnimationId);\n      }\n\n      var _ref4 = [event.touches[0].pageX, event.touches[0].pageY],\n          posX = _ref4[0],\n          posY = _ref4[1];\n\n      if (event.touches.length === 1) {\n        // Check if it is a double tap\n        var touchTime = new Date().getTime();\n\n        if (touchTime - _this.lastTouchTime < _this.props.doubleTouchMaxDelay && touchTime - _this.lastDoubleTapTime > _this.props.doubleTouchMaxDelay) {\n          if (_this.state.zoom === _this.props.minZoom) {\n            _this.fullZoomInOnPosition(posX, posY);\n          } else {\n            _this.reset();\n          }\n\n          _this.lastDoubleTapTime = touchTime;\n        }\n\n        _this.lastTouchTime = touchTime;\n      }\n\n      _this.lastTouch = {\n        posX: posX,\n        posY: posY\n      };\n    });\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"handleTouchMove\", function (event) {\n      event.preventDefault();\n      var _this$props2 = _this.props,\n          maxZoom = _this$props2.maxZoom,\n          minZoom = _this$props2.minZoom;\n      var zoom = _this.state.zoom;\n\n      if (!_this.lastTouch) {\n        return;\n      }\n\n      if (event.touches.length === 1) {\n        var _ref5 = [event.touches[0].pageX, event.touches[0].pageY],\n            posX = _ref5[0],\n            posY = _ref5[1]; // If we detect only one point, we shall just move the element\n\n        var shiftX = posX - _this.lastTouch.posX;\n        var shiftY = posY - _this.lastTouch.posY;\n\n        _this.move(shiftX, shiftY);\n\n        _this.lastShift = {\n          x: shiftX,\n          y: shiftY\n        }; // Save data for the next move\n\n        _this.lastTouch = {\n          posX: posX,\n          posY: posY\n        };\n        _this.lastTouchDistance = null;\n      } else if (event.touches.length > 1) {\n        // If we detect two points, we shall zoom up or down\n        var _ref6 = [event.touches[0].pageX, event.touches[0].pageY],\n            pos1X = _ref6[0],\n            pos1Y = _ref6[1];\n        var _ref7 = [event.touches[1].pageX, event.touches[1].pageY],\n            pos2X = _ref7[0],\n            pos2Y = _ref7[1];\n        var distance = Math.sqrt(Math.pow(pos2X - pos1X, 2) + Math.pow(pos2Y - pos1Y, 2));\n\n        if (_this.lastTouchDistance && distance && distance !== _this.lastTouchDistance) {\n          zoom += (distance - _this.lastTouchDistance) / 100;\n\n          if (zoom > maxZoom) {\n            zoom = maxZoom;\n          } else if (zoom < minZoom) {\n            zoom = minZoom;\n          } // Change position using the center point between the two fingers\n\n\n          var centerX = (pos1X + pos2X) / 2,\n              centerY = (pos1Y + pos2Y) / 2;\n\n          var _this$getNewPosition5 = _this.getNewPosition(centerX, centerY, zoom),\n              _this$getNewPosition6 = (0, _slicedToArray2.default)(_this$getNewPosition5, 2),\n              _posX = _this$getNewPosition6[0],\n              _posY = _this$getNewPosition6[1];\n\n          _this.setState({\n            zoom: zoom,\n            posX: _posX,\n            posY: _posY,\n            transitionDuration: 0\n          });\n        } // Save data for the next move\n\n\n        _this.lastTouch = {\n          posX: pos1X,\n          posY: pos1Y\n        };\n        _this.lastTouchDistance = distance;\n      }\n    });\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"handleTouchStop\", function () {\n      if (_this.lastShift) {\n        // Use the last shift to make a decelerating movement effect\n        _this.startDeceleration(_this.lastShift.x, _this.lastShift.y);\n\n        _this.lastShift = null;\n      }\n\n      _this.lastTouch = null;\n      _this.lastTouchDistance = null;\n    });\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"zoomIn\", function (value) {\n      var maxZoom = _this.props.maxZoom;\n      var _this$state3 = _this.state,\n          zoom = _this$state3.zoom,\n          posX = _this$state3.posX,\n          posY = _this$state3.posY;\n      var prevZoom = zoom;\n      zoom = zoom + value < maxZoom ? zoom + value : maxZoom;\n\n      if (zoom !== prevZoom) {\n        posX = posX * (zoom - 1) / (prevZoom > 1 ? prevZoom - 1 : prevZoom);\n        posY = posY * (zoom - 1) / (prevZoom > 1 ? prevZoom - 1 : prevZoom);\n      }\n\n      _this.setState({\n        zoom: zoom,\n        posX: posX,\n        posY: posY,\n        transitionDuration: _this.props.animDuration\n      });\n    });\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"zoomOut\", function (value) {\n      var minZoom = _this.props.minZoom;\n      var _this$state4 = _this.state,\n          zoom = _this$state4.zoom,\n          posX = _this$state4.posX,\n          posY = _this$state4.posY;\n      var prevZoom = zoom;\n      zoom = zoom - value > minZoom ? zoom - value : minZoom;\n\n      if (zoom !== prevZoom) {\n        posX = posX * (zoom - 1) / (prevZoom - 1);\n        posY = posY * (zoom - 1) / (prevZoom - 1);\n      }\n\n      _this.setState({\n        zoom: zoom,\n        posX: posX,\n        posY: posY,\n        transitionDuration: _this.props.animDuration\n      });\n    });\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"zoomToZone\", function (relX, relY, relWidth, relHeight) {\n      var maxZoom = _this.props.maxZoom;\n      var _this$state5 = _this.state,\n          zoom = _this$state5.zoom,\n          posX = _this$state5.posX,\n          posY = _this$state5.posY;\n\n      var parentRect = _this.ref.current.parentNode.getBoundingClientRect();\n\n      var prevZoom = zoom; // Calculate zoom factor to scale the zone\n\n      var optimalZoomX = parentRect.width / relWidth;\n      var optimalZoomY = parentRect.height / relHeight;\n      zoom = Math.min(optimalZoomX, optimalZoomY, maxZoom); // Calculate new position to center the zone\n\n      var rect = _this.ref.current.getBoundingClientRect();\n\n      var centerX = rect.width / prevZoom / 2,\n          centerY = rect.height / prevZoom / 2;\n      var zoneCenterX = relX + relWidth / 2,\n          zoneCenterY = relY + relHeight / 2;\n      posX = (centerX - zoneCenterX) * zoom;\n      posY = (centerY - zoneCenterY) * zoom;\n\n      _this.setState({\n        zoom: zoom,\n        posX: posX,\n        posY: posY,\n        transitionDuration: _this.props.animDuration\n      });\n    });\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"reset\", function () {\n      _this.setState(_objectSpread(_objectSpread({}, _this.constructor.defaultState), {}, {\n        transitionDuration: _this.props.animDuration\n      }));\n    });\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"getZoom\", function () {\n      return _this.state.zoom;\n    });\n    _this.ref = /*#__PURE__*/(0, _react.createRef)(); // Last cursor position\n\n    _this.lastCursor = null; // Last touch position\n\n    _this.lastTouch = null; // Last touch time in milliseconds\n\n    _this.lastTouchTime = 0; // Last double tap time (used to limit multiple double tap) in milliseconds\n\n    _this.lastDoubleTapTime = 0; // Last calculated distance between two fingers in pixels\n\n    _this.lastTouchDistance = null; // Last request animation frame identifier\n\n    _this.lastRequestAnimationId = null;\n    _this.state = _objectSpread(_objectSpread({}, _this.constructor.defaultState), {}, {\n      transitionDuration: props.animDuration\n    });\n    return _this;\n  }\n  /**\n   * Calculates new translate positions for CSS transformations.\n   * @param  {Number} x     Relative (rect-based) X position in pixels\n   * @param  {Number} y     Relative (rect-based) Y position in pixels\n   * @param  {Number} zoom  Scale value\n   * @return {Array}        New X and Y positions\n   */\n\n\n  (0, _createClass2.default)(PrismaZoom, [{\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(_, prevState) {\n      if (this.props.onZoomChange && this.state.zoom !== prevState.zoom) {\n        this.props.onZoomChange(this.state.zoom);\n      }\n\n      if (this.props.onPanChange && (this.state.posX !== prevState.posX || this.state.posY !== prevState.posY)) {\n        this.props.onPanChange({\n          posX: this.state.posX,\n          posY: this.state.posY\n        });\n      }\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.ref.current.addEventListener('wheel', this.handleMouseWheel.bind(this), {\n        passive: false\n      });\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.ref.current.removeEventListener('wheel', this.handleMouseWheel.bind(this));\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props3 = this.props,\n          className = _this$props3.className,\n          children = _this$props3.children;\n      var _this$state6 = this.state,\n          zoom = _this$state6.zoom,\n          posX = _this$state6.posX,\n          posY = _this$state6.posY,\n          cursor = _this$state6.cursor,\n          transitionDuration = _this$state6.transitionDuration;\n\n      var style = _objectSpread(_objectSpread({}, this.props.style), {}, {\n        transform: \"translate3d(\".concat(posX, \"px, \").concat(posY, \"px, 0) scale(\").concat(zoom, \")\"),\n        transition: \"transform ease-out \".concat(transitionDuration, \"s\"),\n        cursor: cursor,\n        touchAction: 'none',\n        willChange: 'transform'\n      });\n\n      var attr = {\n        ref: this.ref,\n        style: style,\n        className: className\n      };\n\n      if (window.matchMedia(\"(pointer: fine)\").matches) {\n        // Apply mouse events only to devices which include an accurate pointing device\n        attr = _objectSpread(_objectSpread({}, attr), {}, {\n          onDoubleClick: this.handleDoubleClick,\n          onMouseDown: this.handleMouseStart,\n          onMouseMove: this.handleMouseMove,\n          onMouseUp: this.handleMouseStop,\n          onMouseLeave: this.handleMouseStop\n        });\n      } else {\n        // Apply touch events to all other devices\n        attr = _objectSpread(_objectSpread({}, attr), {}, {\n          onTouchStart: this.handleTouchStart,\n          onTouchMove: this.handleTouchMove,\n          onTouchEnd: this.handleTouchStop,\n          onTouchCancel: this.handleTouchStop\n        });\n      }\n\n      return /*#__PURE__*/_react.default.createElement(\"div\", attr, children);\n    }\n  }]);\n  return PrismaZoom;\n}(_react.PureComponent);\n\nexports.default = PrismaZoom;\n(0, _defineProperty2.default)(PrismaZoom, \"propTypes\", {\n  children: _propTypes.default.node.isRequired,\n  className: _propTypes.default.string,\n  style: _propTypes.default.object,\n  minZoom: _propTypes.default.number,\n  maxZoom: _propTypes.default.number,\n  scrollVelocity: _propTypes.default.number,\n  onZoomChange: _propTypes.default.func,\n  onPanChange: _propTypes.default.func,\n  animDuration: _propTypes.default.number,\n  doubleTouchMaxDelay: _propTypes.default.number,\n  decelerationDuration: _propTypes.default.number\n});\n(0, _defineProperty2.default)(PrismaZoom, \"defaultProps\", {\n  // Class name to apply on the zoom wrapper\n  className: null,\n  // Style to apply on the zoom wrapper\n  style: {},\n  // Minimum zoom ratio\n  minZoom: 1,\n  // Maximum zoom ratio\n  maxZoom: 5,\n  // Zoom increment or decrement on each scroll wheel detection\n  scrollVelocity: 0.2,\n  // Function called each time the zoom value changes\n  onZoomChange: null,\n  // Function called each time the posX or posY value changes (aka images was panned)\n  onPanChange: null,\n  // Animation duration (in seconds)\n  animDuration: 0.25,\n  // Max delay between two taps to consider a double tap (in milliseconds)\n  doubleTouchMaxDelay: 300,\n  // Decelerating movement duration after a mouse up or a touch end event (in milliseconds)\n  decelerationDuration: 750\n});\n(0, _defineProperty2.default)(PrismaZoom, \"defaultState\", {\n  // Transform scale value property\n  zoom: 1,\n  // Transform translateX value property\n  posX: 0,\n  // Transform translateY value property\n  posY: 0,\n  // Cursor style property\n  cursor: 'auto'\n});"]},"metadata":{},"sourceType":"script"}