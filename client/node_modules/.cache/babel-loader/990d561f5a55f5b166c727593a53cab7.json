{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/home/jun/foodbank/client/src/Components/Map/index.tsx\",\n    _s = $RefreshSig$();\n\n// naming conventions of items in svg = id of group in camelCase, image import name in PascalCase.\n// svg tree generated from dev/svgParse.py (super hacky atm)\nimport React, { useEffect, useRef, useState } from 'react';\nimport './index.css';\nimport { Location } from '../../lib/types';\nimport svgData from './svgImageData.json';\nimport mapImg from './assets/TuckerMap.jpg';\nimport descData from './assets/description.json';\nimport Townbox from '../Townbox'; //import { MapInteractionCSS } from 'react-map-interaction';\n//import PrismaZoom from 'react-prismazoom';\n//import InnerImageZoom from 'react-inner-image-zoom'\n\nconst Map = () => {\n  _s();\n\n  // Used because SVG does not scale properly without\n  const [height, setHeight] = useState(0);\n  const [width, setWidth] = useState(0);\n  const elementRef = useRef(null);\n  const [selected, onSelect] = useState(null);\n  const [scale, setScale] = useState(1);\n  const [townbox, setTownbox] = useState( /*#__PURE__*/_jsxDEV(_Fragment, {}, void 0, false));\n  useEffect(() => {\n    var _elementRef$current;\n\n    if (elementRef === null || elementRef === void 0 ? void 0 : (_elementRef$current = elementRef.current) === null || _elementRef$current === void 0 ? void 0 : _elementRef$current.clientHeight) {\n      var _elementRef$current2;\n\n      setHeight(elementRef === null || elementRef === void 0 ? void 0 : (_elementRef$current2 = elementRef.current) === null || _elementRef$current2 === void 0 ? void 0 : _elementRef$current2.clientHeight);\n    }\n  }, []); //empty dependency array so it only runs once at render\n\n  useEffect(() => {\n    function handleResize() {\n      setScale(window.innerWidth / 4961);\n      console.log('resized to: ', window.innerWidth, 'x', window.innerHeight);\n    }\n\n    window.addEventListener('resize', handleResize);\n  });\n  useEffect(() => {\n    var _elementRef$current3;\n\n    if (elementRef === null || elementRef === void 0 ? void 0 : (_elementRef$current3 = elementRef.current) === null || _elementRef$current3 === void 0 ? void 0 : _elementRef$current3.clientWidth) {\n      var _elementRef$current4;\n\n      setWidth(elementRef === null || elementRef === void 0 ? void 0 : (_elementRef$current4 = elementRef.current) === null || _elementRef$current4 === void 0 ? void 0 : _elementRef$current4.clientWidth);\n      setScale(width / 4961);\n    }\n  }, [width]); // to get the area description given an area so you can actually use headers/captions\n  // returns null if such area doesn't exist in assets/description.json\n\n  const getAreaDescription = area => {\n    for (const description of descData.descriptionArray) {\n      if (description.id === Location[area]) {\n        return description;\n      }\n    }\n\n    return null;\n  };\n\n  const onMapClick = area => {\n    const areaDescription = getAreaDescription(area);\n    console.log(Location[area]);\n    let i;\n\n    for (i = 0; i < svgData.groupArray.length; i++) {\n      if (svgData.groupArray[i].id == Location[area]) {\n        console.log(\"test\", svgData.groupArray[i].id, Location[area]);\n\n        if (selected !== area) {\n          //svgData.groupArray[i].transform = \"translate(0 0) scale(1)\"\n          const bounds = [svgData.groupArray[i].width, svgData.groupArray[i].height];\n          const scalingTerm = svgData.groupArray[i].transform.match(/translate\\(.*\\)/);\n\n          if (scalingTerm != null) {\n            console.log(scalingTerm);\n            const scalingTermStr = scalingTerm[0];\n            const scalingFactorStr = scalingTermStr.match(/\\d+\\.?\\d*/g);\n\n            if (scalingFactorStr != null) {\n              //console.log(scalingFactorStr[0])\n              const center = [Number(scalingFactorStr[0]) / 2, Number(scalingFactorStr[1]) / 2];\n              console.log('center', center);\n              const original = [center[0], center[1], Number(bounds[0]) + padding - Number(bounds[1]) + padding];\n              console.log(\"original\", original);\n              console.log(\"original2\", original[2]);\n              const end = [svgViewBoxWidth / 2, svgViewBoxHeight / 2, svgViewBoxWidth / 2];\n              console.log(\"end\", end);\n              const k = Math.min(svgViewBoxWidth, svgViewBoxHeight) / Number(original[2]);\n              console.log(\"k\", k);\n              const translate = [svgViewBoxWidth / 2 - Number(original[0]) * k, svgViewBoxHeight / 2 - Number(original[1]) * k];\n              console.log(\"translateTest\", translate);\n              svgData.groupArray[i].transform = \"translate(\" + translate[0] + \" \" + translate[1] + \") scale(\" + k + \" \" + k + \")\";\n            }\n          }\n\n          console.log(\"finalTransform\", svgData.groupArray[i].transform);\n        }\n        /*else {\n           svgData.groupArray[i].transform = \"translate(0 0) scale(0.15)\"\n        }*/\n\n      }\n      /*else{\n         svgData.groupArray[i].width = '0'\n      }*/\n\n    }\n\n    if (selected !== area) {\n      const header = areaDescription === null || areaDescription === void 0 ? void 0 : areaDescription.headerText;\n      const caption = areaDescription === null || areaDescription === void 0 ? void 0 : areaDescription.captionText;\n      const showButton = areaDescription === null || areaDescription === void 0 ? void 0 : areaDescription.showButton;\n      const headerColor = areaDescription === null || areaDescription === void 0 ? void 0 : areaDescription.headerColor;\n      const maxWidth = areaDescription === null || areaDescription === void 0 ? void 0 : areaDescription.maxWidth;\n      const maxHeight = areaDescription === null || areaDescription === void 0 ? void 0 : areaDescription.maxHeight;\n      setTownbox( /*#__PURE__*/_jsxDEV(Townbox, {\n        maxWidth: maxWidth,\n        maxHeight: maxHeight,\n        headerColor: headerColor,\n        headerText: header,\n        captionText: caption,\n        showButton: showButton\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 9\n      }, this));\n    }\n\n    selected === area ? onSelect(null) : onSelect(area);\n  }; // eslint-disable-next-line\n\n\n  const handleClick = event => {\n    //need to change this type\n    event.preventDefault();\n    const area = event.target.alt;\n    onMapClick(Location[area]);\n  }; // Data can be made from dev/svgParse.py\n\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    ref: elementRef,\n    className: \"flex-auto 2xl:flex-none xl:flex-none 2xl:h-4/5 xl:h-4/5 flex justify-center\",\n    children: height === 0 ? null : /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"svgrow\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          position: \"relative\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: mapImg,\n          alt: \"Tucker Island Map\",\n          useMap: \"#tuckerislandmap\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 140,\n          columnNumber: 15\n        }, this), svgData.groupArray.map(location => {\n          const xtrans = parseInt(location.xtrans) * scale * 8; // I have no clue why everything is overscaled 8x\n\n          const ytrans = parseInt(location.ytrans) * scale * 8; // this is probably worth looking into\n\n          const translation = \"translate(\" + String(xtrans) + \"px, \" + String(ytrans) + \"px)\";\n          const up = [\"aquaOcean\", \"zombieWasteland\", \"grainField\"];\n          const left = [\"yoghurtMountains\", \"cluckyCoop\", \"grainField\", \"supplyStore\", \"wickedWaterway\"]; //console.log(translation);\n\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              position: \"absolute\",\n              zIndex: 4,\n              top: 0,\n              transform: translation\n            },\n            children: [location.name, selected === Location[location.id] && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: `townBox ${up.includes(location.id) ? \"up\" : \"\"} ${left.includes(location.id) ? \"left \" : \"\"}`,\n              children: townbox\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 154,\n              columnNumber: 23\n            }, this)]\n          }, location.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 150,\n            columnNumber: 19\n          }, this);\n        })]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"map\", {\n        name: \"tuckerislandmap\",\n        children: svgData.groupArray.map(location => {\n          if (location.coords) {\n            const scaledCoords = location.coords.map(coord => coord * scale);\n            const className = Location[location.id] === selected ? 'map-selected' : 'map-unselected';\n            return /*#__PURE__*/_jsxDEV(\"area\", {\n              alt: location.id,\n              onClick: handleClick,\n              href: location.id,\n              coords: scaledCoords.join(),\n              className: className,\n              shape: \"poly\"\n            }, location.id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 170,\n              columnNumber: 27\n            }, this);\n          }\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 11\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 131,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Map, \"aRS23Uhfxa2CI3re6S02D2KkgjM=\");\n\n_c = Map;\nexport default Map;\n\nvar _c;\n\n$RefreshReg$(_c, \"Map\");","map":{"version":3,"sources":["/home/jun/foodbank/client/src/Components/Map/index.tsx"],"names":["React","useEffect","useRef","useState","Location","svgData","mapImg","descData","Townbox","Map","height","setHeight","width","setWidth","elementRef","selected","onSelect","scale","setScale","townbox","setTownbox","current","clientHeight","handleResize","window","innerWidth","console","log","innerHeight","addEventListener","clientWidth","getAreaDescription","area","description","descriptionArray","id","onMapClick","areaDescription","i","groupArray","length","bounds","scalingTerm","transform","match","scalingTermStr","scalingFactorStr","center","Number","original","padding","end","svgViewBoxWidth","svgViewBoxHeight","k","Math","min","translate","header","headerText","caption","captionText","showButton","headerColor","maxWidth","maxHeight","handleClick","event","preventDefault","target","alt","position","map","location","xtrans","parseInt","ytrans","translation","String","up","left","zIndex","top","name","includes","coords","scaledCoords","coord","className","join"],"mappings":"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","sourcesContent":["// naming conventions of items in svg = id of group in camelCase, image import name in PascalCase.\n// svg tree generated from dev/svgParse.py (super hacky atm)\n\nimport React, { useEffect, useRef, useState } from 'react'\nimport './index.css'\nimport { Location } from '../../lib/types'\nimport svgData from './svgImageData.json'\nimport mapImg from './assets/TuckerMap.jpg'\nimport descData from './assets/description.json'\nimport Townbox from '../Townbox'\n//import { MapInteractionCSS } from 'react-map-interaction';\n//import PrismaZoom from 'react-prismazoom';\n//import InnerImageZoom from 'react-inner-image-zoom'\n\nconst Map: React.FC = () => {\n  // Used because SVG does not scale properly without\n  const [height, setHeight] = useState(0)\n  const [width, setWidth] = useState(0)\n  const elementRef = useRef(null as null | HTMLDivElement)\n  const [selected, onSelect] = useState<Location | null>(null)\n  const [scale, setScale] = useState(1)\n  const [townbox, setTownbox] = useState(<></>)\n  type HeaderColor = 'primary' | 'orange';\n  useEffect(() => {\n    if (elementRef?.current?.clientHeight) {\n      setHeight(elementRef?.current?.clientHeight)\n    }\n  }, []) //empty dependency array so it only runs once at render\n\n  useEffect(() => {\n    function handleResize() {\n      setScale(window.innerWidth/4961)\n      console.log('resized to: ', window.innerWidth, 'x', window.innerHeight)\n    } window.addEventListener('resize', handleResize)})\n\n  useEffect(() => {\n    if (elementRef?.current?.clientWidth) {\n      setWidth(elementRef?.current?.clientWidth)\n      setScale(width/4961)\n    }\n  }, [width])\n\n  // to get the area description given an area so you can actually use headers/captions\n  // returns null if such area doesn't exist in assets/description.json\n  const getAreaDescription = (area: Location) => {\n    for(const description of descData.descriptionArray) {\n      if (description.id === Location[area]) {\n        return description\n      }\n    }\n\n    return null\n  }\n\n  const onMapClick = (area: Location) => {\n    const areaDescription = getAreaDescription(area)\n    console.log(Location[area])\n    let i;\n    for(i=0; i < svgData.groupArray.length; i++) {\n       if ((svgData.groupArray[i].id == Location[area])) {\n         console.log(\"test\", svgData.groupArray[i].id, Location[area])\n         if(selected !== area) {\n           //svgData.groupArray[i].transform = \"translate(0 0) scale(1)\"\n           const bounds = [svgData.groupArray[i].width, svgData.groupArray[i].height]\n           const scalingTerm = svgData.groupArray[i].transform.match(/translate\\(.*\\)/)\n           if(scalingTerm != null)  {\n            console.log(scalingTerm)\n            const scalingTermStr = scalingTerm[0]\n            const scalingFactorStr = scalingTermStr.match(/\\d+\\.?\\d*/g)\n            if(scalingFactorStr != null)  {\n              //console.log(scalingFactorStr[0])\n              const center = [Number(scalingFactorStr[0])/2, Number(scalingFactorStr[1])/2]\n              console.log('center', center)\n              const original = [center[0], center[1], Number(bounds[0])+padding-Number(bounds[1])+padding]\n              console.log(\"original\", original)\n              console.log(\"original2\", original[2])\n              const end = [svgViewBoxWidth/2, svgViewBoxHeight/2, svgViewBoxWidth/2]\n              console.log(\"end\", end)\n              const k = Math.min(svgViewBoxWidth, svgViewBoxHeight)/Number(original[2])\n              console.log(\"k\", k)\n              const translate = [svgViewBoxWidth/2-Number(original[0])*k, svgViewBoxHeight/2 - Number(original[1]) * k]\n              console.log(\"translateTest\", translate)\n              svgData.groupArray[i].transform = \"translate(\" + translate[0] + \" \" + translate[1] + \") scale(\" +k+ \" \" +k+\")\"\n            }\n            \n           }\n           \n           console.log(\"finalTransform\", svgData.groupArray[i].transform)\n         }\n\n        /*else {\n           svgData.groupArray[i].transform = \"translate(0 0) scale(0.15)\"\n        }*/\n       }\n\n       /*else{\n          svgData.groupArray[i].width = '0'\n       }*/\n    }\n    if(selected !== area) {\n      const header = areaDescription?.headerText\n      const caption = areaDescription?.captionText\n      const showButton = areaDescription?.showButton\n      const headerColor:HeaderColor = areaDescription?.headerColor as HeaderColor;\n      const maxWidth = areaDescription?.maxWidth\n      const maxHeight = areaDescription?.maxHeight\n\n      setTownbox(\n        <Townbox \n          maxWidth={maxWidth} \n          maxHeight={maxHeight}\n          headerColor={headerColor}\n          headerText={header}\n          captionText={caption}\n          showButton = {showButton}\n        />\n      )\n    }\n\n    selected === area ? onSelect(null) : onSelect(area)\n  }\n  // eslint-disable-next-line\n  const handleClick = (event: any) => { //need to change this type\n    event.preventDefault()\n    const area = event.target.alt\n    onMapClick(Location[area as keyof typeof Location])\n  }\n\n  // Data can be made from dev/svgParse.py\n  return (\n    <div\n      ref={elementRef}\n      className='flex-auto 2xl:flex-none xl:flex-none 2xl:h-4/5 xl:h-4/5 flex justify-center'\n    >\n      \n      \n      {height === 0 ? null : (\n          <div className='svgrow'>\n            <div style={{position:\"relative\"}}>\n              <img src={mapImg} alt=\"Tucker Island Map\" useMap=\"#tuckerislandmap\"/>\n              \n              {svgData.groupArray.map(location =>{\n                const xtrans = parseInt(location.xtrans) * scale * 8; // I have no clue why everything is overscaled 8x\n                const ytrans = parseInt(location.ytrans) * scale * 8; // this is probably worth looking into\n                const translation = \"translate(\" + String(xtrans) + \"px, \" + String(ytrans) + \"px)\";\n                const up = [\"aquaOcean\", \"zombieWasteland\", \"grainField\"]\n                const left = [\"yoghurtMountains\", \"cluckyCoop\", \"grainField\", \"supplyStore\", \"wickedWaterway\"]\n                //console.log(translation);\n                return (\n                  <div key={location.id} style={{position:\"absolute\", zIndex:4, top:0, transform:translation}}>\n                    {location.name} \n                    {\n                      selected === Location[location.id as keyof typeof Location] &&\n                      <div className={`townBox ${up.includes(location.id)? \"up\" : \"\"} ${left.includes(location.id)? \"left \" : \"\"}`}>{townbox}</div>\n                    }\n                  </div>\n                )\n              })}\n            </div>\n            \n            <map name=\"tuckerislandmap\">\n              {\n                svgData.groupArray.map(location => {\n                  if (location.coords){\n                    const scaledCoords = location.coords.map(coord => coord*scale)\n                    const className = Location[location.id as keyof typeof Location] === selected\n                          ? 'map-selected'\n                          : 'map-unselected'\n                    return (\n                          <area \n                            key={location.id}\n                            alt={location.id}\n                            onClick={handleClick}\n                            href={location.id}\n                            coords={scaledCoords.join()}\n                            className={className}\n                            shape=\"poly\"\n                          />\n                    )\n                  }\n                })\n              }\n            </map>\n        </div>\n      )}\n    </div>\n  )\n}\n\nexport default Map\n"]},"metadata":{},"sourceType":"module"}